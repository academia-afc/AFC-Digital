<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Academia AFC - Cursos y Plantillas</title>
    
    <link rel="icon" type="image/png" href="logo.png">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap');
        body { background-color: #FDFDFD; font-family: 'Plus Jakarta Sans', sans-serif; -webkit-tap-highlight-color: transparent; }
        
        .text-fv-blue { color: #002e5f; }
        .bg-fv-blue { background-color: #002e5f; }
        .bg-fv-orange { background-color: #e85d04; }
        
        .card-shadow { transition: all 0.3s ease; border: 1px solid #f0f0f0; }
        .card-shadow:hover { transform: translateY(-5px); border-color: #002e5f; box-shadow: 0 20px 25px -5px rgba(0, 46, 95, 0.1); }
        
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        .banner-hero {
            background: linear-gradient(90deg, rgba(0,46,95,0.95) 0%, rgba(0,46,95,0.8) 50%, rgba(0,46,95,0.4) 100%), 
                        url('https://images.unsplash.com/photo-1522202176988-66273c2fd55f?q=80&w=2071&auto=format&fit=crop');
            background-size: cover; background-position: center;
        }

        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .animate-slide-up { animation: slideUp 0.3s ease-out; }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <div class="max-w-[1400px] mx-auto bg-white min-h-screen flex flex-col shadow-sm w-full relative">
        
        <header class="px-6 py-4 sticky top-0 z-50 bg-white/90 backdrop-blur-md flex justify-between items-center border-b border-gray-100 h-[80px]">
            <div class="flex items-center gap-3">
                <img src="logo.png" alt="AFC Digital" class="h-10 object-contain">
                <span class="font-black text-fv-blue text-xl tracking-tighter uppercase">AFC Digital</span>
            </div>
            <button onclick="toggleCart()" class="relative p-2 hover:bg-gray-100 rounded-full transition">
                <i class="fa-solid fa-cart-shopping text-2xl text-fv-blue"></i>
                <span id="cart-count" class="absolute top-0 right-0 bg-orange-600 text-white text-[10px] font-bold h-5 w-5 flex items-center justify-center rounded-full border-2 border-white">0</span>
            </button>
        </header>

        <section class="banner-hero p-8 md:p-20 flex items-center min-h-[350px] relative text-white">
            <div class="relative z-10 max-w-3xl">
                <span class="bg-fv-orange px-3 py-1 font-bold text-xs uppercase tracking-widest mb-4 inline-block">Impulsa tu futuro</span>
                <h1 class="text-5xl md:text-7xl font-extrabold leading-none mb-4 uppercase italic">Tu Academia <br><span class="text-fv-orange not-italic">Digital</span></h1>
                <p class="text-blue-50 text-lg md:text-xl font-medium max-w-xl">Conocimiento, Cursos y Herramientas para Emprendedores Digitales.</p>
            </div>
        </section>

        <div class="p-6 border-b border-gray-100 sticky top-[80px] bg-white z-40 shadow-sm">
            <div class="flex flex-col md:flex-row gap-4 justify-between items-center">
                <nav id="category-nav" class="flex gap-2 overflow-x-auto w-full md:w-auto hide-scrollbar pb-1"></nav>
                
                <div class="flex flex-col sm:flex-row gap-3 w-full md:w-auto items-center">
                    <div class="relative w-full sm:w-48">
                        <select id="sort-select" onchange="applyFilters()" class="w-full pl-3 pr-10 py-3 bg-gray-50 border border-gray-300 rounded-2xl text-xs font-bold text-gray-700 outline-none focus:ring-2 focus:ring-fv-blue/10 appearance-none cursor-pointer uppercase">
                            <option value="recent">M√°s Recientes</option>
                            <option value="asc">Precio: Bajo a Alto</option>
                            <option value="desc">Precio: Alto a Bajo</option>
                            <option value="az">Nombre: A - Z</option>
                            <option value="za">Nombre: Z - A</option>
                        </select>
                        <i class="fa-solid fa-chevron-down absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none text-[10px]"></i>
                    </div>

                    <div class="relative w-full md:w-72">
                        <i class="fa-solid fa-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"></i>
                        <input type="text" id="search-input" oninput="applyFilters()" placeholder="¬øQu√© buscas?" class="w-full pl-11 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-2xl text-xs focus:outline-none focus:ring-2 focus:ring-fv-blue/10">
                    </div>
                </div>
            </div>
        </div>

        <main class="p-6 md:p-10 flex-grow bg-gray-50/30">
            <div id="product-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        </main>

        <footer class="bg-fv-blue text-white py-14 px-6 border-t-4 border-fv-orange mt-auto text-center">
            <h2 class="text-3xl font-black mb-2 tracking-tighter uppercase">AFC DIGITAL</h2>
            <div class="flex justify-center gap-6 mb-8">
                <a href="https://wa.me/573114957971" target="_blank" class="w-12 h-12 bg-green-500 rounded-2xl flex items-center justify-center hover:scale-110 transition shadow-lg"><i class="fa-brands fa-whatsapp text-2xl"></i></a>
            </div>
            <p class="text-blue-100 text-sm uppercase tracking-widest mb-4">Educaci√≥n ¬∑ Transformaci√≥n ¬∑ Innovaci√≥n</p>
            <p class="text-blue-200/50 text-xs italic">¬© 2026 AFC Digital. Todos los derechos reservados.</p>
        </footer>
    </div>

    <div id="product-modal" class="hidden fixed inset-0 bg-fv-blue/95 z-[100] flex items-center justify-center p-4 backdrop-blur-md">
        <div class="bg-white w-full max-w-xl rounded-3xl overflow-hidden relative shadow-2xl animate-slide-up">
            <button onclick="closeModal()" class="absolute top-4 right-4 w-10 h-10 bg-black/5 hover:bg-black/10 rounded-full flex items-center justify-center transition text-gray-500"><i class="fa-solid fa-times text-xl"></i></button>
            <img id="modal-img" src="" class="w-full h-64 object-cover">
            <div class="p-8">
                <span id="modal-type" class="text-fv-orange font-bold text-xs uppercase tracking-widest"></span>
                <h2 id="modal-title" class="text-2xl font-extrabold text-fv-blue mt-2 mb-4 leading-tight"></h2>
                
                <div class="flex items-center justify-between mb-8 bg-gray-50 p-5 rounded-2xl border border-gray-100">
                    <span class="text-gray-500 font-bold">Inversi√≥n:</span>
                    <span id="modal-price" class="text-3xl font-black text-fv-blue"></span>
                </div>

                <div class="grid grid-cols-2 gap-3">
                    <button onclick="shareSingleProduct()" class="bg-green-500 text-white rounded-2xl py-4 font-bold flex items-center justify-center gap-2 hover:bg-green-600 transition shadow-md">
                        <i class="fa-brands fa-whatsapp text-xl"></i> Compartir
                    </button>
                    <button onclick="addToCartFromModal()" class="bg-fv-blue text-white rounded-2xl py-4 font-bold flex items-center justify-center gap-2 hover:opacity-90 transition shadow-md">
                        <i class="fa-solid fa-cart-plus"></i> A√±adir
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="cart-modal" class="hidden fixed inset-0 bg-black/60 z-[200] flex justify-end">
        <div class="bg-white w-full max-w-md h-full flex flex-col">
            <div class="p-6 border-b flex justify-between items-center">
                <h2 class="text-2xl font-black text-fv-blue uppercase">Tu Selecci√≥n</h2>
                <button onclick="toggleCart()" class="text-gray-400 hover:text-gray-600"><i class="fa-solid fa-xmark text-xl"></i></button>
            </div>
            <div id="cart-items" class="flex-grow overflow-y-auto p-6 space-y-4 bg-gray-50"></div>
            <div class="p-6 border-t bg-white">
                <div class="flex justify-between items-center mb-6">
                    <span class="font-bold text-gray-500 uppercase text-xs">Subtotal:</span>
                    <span id="cart-total" class="text-3xl font-black text-fv-blue">$0</span>
                </div>
                <button onclick="sendOrderWhatsApp()" class="w-full bg-[#25D366] text-white py-4 rounded-2xl font-black text-lg flex items-center justify-center gap-3 shadow-lg">
                    <i class="fa-brands fa-whatsapp text-2xl"></i> Confirmar Inscripci√≥n
                </button>
            </div>
        </div>
    </div>

    <script>
        const WHATSAPP_NUMBER = '3114957971';
        const SHEET_ID = '17a0Pxq1EOLRf86yiuM014ZluVqL2Qj1Mt8cKRDenjHc';
        const GID = '394732865'; 
        const CSV_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=${GID}`;

        let allProducts = [];
        let cart = [];
        let currentCategory = 'Ver Todo';
        let selectedProduct = null;

        function formatMoney(amount) {
            return amount.toLocaleString('es-CO', { style: 'currency', currency: 'COP', minimumFractionDigits: 0 });
        }

        function loadProducts() {
            Papa.parse(CSV_URL, {
                download: true, header: true, skipEmptyLines: true,
                complete: function(results) {
                    allProducts = results.data.filter(row => row.SKU).map((row, index) => ({
                        sku: row.SKU,
                        nombre: row.NOMBRE,
                        precio: parseFloat(row['PRECIO DE VENTA']?.replace(/[^0-9.]/g, '')) || 0,
                        img: row.IMAGEN?.trim() || 'https://via.placeholder.com/600x400',
                        tipo: row.TIPO || 'Curso',
                        index: index // Para orden reciente
                    }));
                    updateCategoryNav();
                    applyFilters();
                    checkUrlForProduct(); 
                }
            });
        }

        function updateCategoryNav() {
            const types = ['Ver Todo', ...new Set(allProducts.map(p => p.tipo))].sort();
            document.getElementById('category-nav').innerHTML = types.map(t => `
                <button onclick="filterType('${t}')" class="px-5 py-2 rounded-xl text-sm font-bold whitespace-nowrap border transition-all ${t === currentCategory ? 'bg-fv-blue text-white shadow-md' : 'bg-gray-100 text-gray-500 hover:bg-gray-200'}">${t}</button>
            `).join('');
        }

        function filterType(t) { currentCategory = t; updateCategoryNav(); applyFilters(); }

        function applyFilters() {
            const search = document.getElementById('search-input').value.toLowerCase();
            const sortMode = document.getElementById('sort-select').value;

            let filtered = allProducts.filter(p => {
                const matchType = currentCategory === 'Ver Todo' || p.tipo === currentCategory;
                const matchSearch = p.nombre.toLowerCase().includes(search);
                return matchType && matchSearch;
            });

            if (sortMode === 'asc') filtered.sort((a, b) => a.precio - b.precio);
            else if (sortMode === 'desc') filtered.sort((a, b) => b.precio - a.precio);
            else if (sortMode === 'az') filtered.sort((a, b) => a.nombre.localeCompare(b.nombre));
            else if (sortMode === 'za') filtered.sort((a, b) => b.nombre.localeCompare(a.nombre));
            else if (sortMode === 'recent') filtered.sort((a, b) => b.index - a.index);

            renderGrid(filtered);
        }

        function renderGrid(products) {
            const grid = document.getElementById('product-grid');
            grid.innerHTML = products.map(p => `
                <div class="bg-white rounded-3xl overflow-hidden card-shadow flex flex-col cursor-pointer relative group">
                    <div onclick="openModal('${p.sku}')" class="h-56 overflow-hidden">
                        <img src="${p.img}" class="w-full h-full object-cover group-hover:scale-105 transition duration-500">
                        <div class="absolute top-4 left-4 bg-white/90 backdrop-blur px-3 py-1 rounded-lg text-[10px] font-black uppercase text-fv-blue shadow-sm">${p.tipo}</div>
                    </div>
                    <div class="p-6 flex flex-col flex-grow">
                        <h3 onclick="openModal('${p.sku}')" class="font-extrabold text-lg text-gray-900 leading-tight mb-4 h-12 line-clamp-2">${p.nombre}</h3>
                        <div class="mt-auto flex justify-between items-center pt-5 border-t border-gray-100">
                            <p class="text-xl font-black text-fv-blue">${formatMoney(p.precio)}</p>
                            <div class="flex gap-2">
                                <button onclick="quickShare('${p.sku}')" class="w-10 h-10 bg-green-50 text-green-600 rounded-xl flex items-center justify-center hover:bg-green-100 transition shadow-sm"><i class="fa-brands fa-whatsapp text-lg"></i></button>
                                <button onclick="quickAdd('${p.sku}')" class="w-10 h-10 bg-gray-900 text-white rounded-xl flex items-center justify-center hover:bg-fv-blue transition shadow-md"><i class="fa-solid fa-plus text-lg"></i></button>
                            </div>
                        </div>
                    </div>
                </div>`).join('');
        }

        function openModal(sku) {
            selectedProduct = allProducts.find(p => p.sku === sku);
            if(!selectedProduct) return;
            document.getElementById('modal-title').innerText = selectedProduct.nombre;
            document.getElementById('modal-type').innerText = selectedProduct.tipo;
            document.getElementById('modal-price').innerText = formatMoney(selectedProduct.precio);
            document.getElementById('modal-img').src = selectedProduct.img;
            window.history.pushState({}, '', `?p=${sku}`);
            document.getElementById('product-modal').classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('product-modal').classList.add('hidden');
            window.history.pushState({}, '', window.location.pathname);
        }

        function quickAdd(sku) {
            const p = allProducts.find(prod => prod.sku === sku);
            if(!cart.find(c => c.sku === sku)) cart.push(p);
            updateCartUI();
        }

        function addToCartFromModal() { quickAdd(selectedProduct.sku); closeModal(); }

        function quickShare(sku) {
            const p = allProducts.find(prod => prod.sku === sku);
            const url = `${window.location.origin}${window.location.pathname}?p=${sku}`;
            const text = `üöÄ ¬°Mira este curso en AFC Digital!\n\n*${p.nombre}*\n\nInfo aqu√≠: ${url}`;
            window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
        }

        function shareSingleProduct() { quickShare(selectedProduct.sku); }

        function checkUrlForProduct() {
            const params = new URLSearchParams(window.location.search);
            const pSku = params.get('p');
            if(pSku) setTimeout(() => openModal(pSku), 500);
        }

        function updateCartUI() {
            document.getElementById('cart-count').innerText = cart.length;
            const container = document.getElementById('cart-items');
            let total = 0;
            container.innerHTML = cart.map((item, i) => {
                total += item.precio;
                return `
                    <div class="flex gap-4 bg-white p-3 rounded-2xl border border-gray-100 shadow-sm">
                        <img src="${item.img}" class="w-16 h-16 object-cover rounded-xl bg-gray-50">
                        <div class="flex-grow">
                            <p class="font-bold text-xs text-fv-blue line-clamp-1">${item.nombre}</p>
                            <p class="font-black text-sm mt-1">${formatMoney(item.precio)}</p>
                        </div>
                        <button onclick="removeFromCart(${i})" class="text-red-400 px-2"><i class="fa-solid fa-trash-can"></i></button>
                    </div>`;
            }).join('');
            document.getElementById('cart-total').innerText = formatMoney(total);
        }

        function removeFromCart(i) { cart.splice(i, 1); updateCartUI(); }
        function toggleCart() { document.getElementById('cart-modal').classList.toggle('hidden'); }

        function sendOrderWhatsApp() {
            if(cart.length === 0) return;
            let msg = `üéì *INSCRIPCI√ìN - AFC DIGITAL*%0A%0AHola, deseo inscribirme en los siguientes cursos:%0A%0A`;
            cart.forEach(item => msg += `‚Ä¢ *${item.nombre}* (${formatMoney(item.precio)})%0A`);
            const total = cart.reduce((acc, i) => acc + i.precio, 0);
            msg += `%0A*TOTAL: ${formatMoney(total)}*%0A%0AInd√≠queme los pasos de pago.`;
            window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${msg}`, '_blank');
        }

        loadProducts();
    </script>
</body>
</html>
